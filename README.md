# My Awesome MCP Server

This project was generated by `create-motoko-mcp-server` and provides a complete, ready-to-deploy Motoko MCP server for the [Prometheus Protocol](https://github.com/prometheus-protocol/prometheus-protocol) ecosystem.

This guide assumes you are using `npm` as your package manager.

## Prerequisites

Before you begin, make sure you have the following tools installed on your system:

1.  **DFX:** The DFINITY Canister SDK. [Installation Guide](https://dfinity.org/developers).
2.  **Node.js:** Version 18.0 or higher. [Download](https://nodejs.org/).
3.  **MOPS:** The Motoko Package Manager. [Installation Guide](https://mops.one/docs/install).

---

## Part 1: Quick Start

This section guides you from zero to a working, testable MCP server in minutes.

### Step 1: Install Dependencies

This command will install both the required Node.js packages and the Motoko packages.

```bash
npm install
npm run mops:install
```

### Step 2: Deploy Your Server Locally

1.  **Start the Local Replica:**
    ```bash
    npm run start
    ```
2.  **Deploy to the Local Replica:** (In a new terminal window)
    ```bash
    npm run deploy
    ```

### Step 3: Test with the MCP Inspector

Your server is live and its default `echo` tool is ready to use.

1.  **Launch the Inspector:**
    ```bash
    npm run inspector
    ```
2.  **Connect to Your Canister:** Use the local canister ID endpoint provided in the `dfx deploy` output.
    ```
    # Replace `your_canister_id` with the actual ID from the deploy output
    http://127.0.0.1:4943/mcp/?canisterId=your_canister_id
    ```
ðŸŽ‰ **Congratulations!** You have a working MCP server.

---

## Part 2: Enable Monetization (Optional)

Ready to add paid tools? Follow these steps to enable the Prometheus OAuth flow.

### Step 1: Activate the Auth Code in Your Canister

1.  Open `src/main.mo`.
2.  Uncomment the large block of code that initializes the `authContext`.
3.  Save the file.
4.  Run `npm run deploy` again to update your canister with the authentication logic.

Your server's tools are now protected and require a valid token to be called.

### Step 2: Register with the Auth Server

Use the built-in `auth` script to interact with the Prometheus Auth Server.

1.  **Register Your Server:** This command registers your application as a client.
    ```bash
    npm run auth register
    ```

*Tip: See all available commands by running `npm run auth -- --help`.*

---

## Part 3: Publish to the Prometheus App Store

This section guides you through submitting your server for verification and discovery.

### Step 1: Initialize Your Submission Package

The `init` command runs an interactive wizard that will create your `prometheus.yml` manifest.

```bash
# Run this command from your project's root directory
npm run app-store init
```

### Step 2: Add Your Git Commit Hash

For auditability, the submission requires the exact Git commit hash of the code you are deploying.

1.  **Commit your latest changes:**
    ```bash
    git add .
    git commit -m "Prepare for initial submission"
    ```
2.  **Get the commit hash:**
    ```bash
    git rev-parse HEAD
    ```
3.  **Update your manifest:** Open `prometheus.yml` and paste the commit hash into the `git_commit` field.

### Step 3: Submit for Verification

With your manifest complete, you can now submit your application for its first audit.

```bash
npm run app-store submit
```

### Step 4: Monitor Verification Status

Check the status of your submission at any time. Once all required audits are complete and finalized by the DAO, your server will receive its official verification tier.

```bash
npm run app-store status
```

### Step 5: Publish Your Verified WASM

After your submission has been successfully audited, the final step is to publish the WASM file to the Prometheus Registry.

```bash
# Note the '--' which is required to pass arguments to the script
npm run app-store -- publish --app-version "0.1.0"
```

ðŸŽ‰ **Success!** Your application is now fully published and discoverable in the Prometheus App Store.

---

## Deploying to Production

1.  **Deploy to the IC Mainnet:**
    ```bash
    npm run deploy:ic
    ```

2.  **Update OAuth Redirect URI:** **(Important!)** If you enabled monetization, you must run `npm run auth update` again and change the `redirect_uri` to your production URL.
    ```
    # Example Production Canister URL
    https://your_canister_id.icp0.io/
    ```

## What's Next?

-   **Customize Your Tool:** Open `src/main.mo` to start building your own custom MCP tools.
-   **Learn More:** Check out the [Motoko MCP SDK documentation](https://github.com/prometheus-protocol/motoko-sdk) for advanced features.# motoko-mcp-example
